<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Map Maker 9000</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 0;
    }
    #grid-container {
      display: grid;
      grid-gap: 2px;
      margin: 20px 0;
      user-select: none;
    }
    .cell {
      width: 30px;
      height: 30px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      color: white;
      border: 1px solid #999;
    }
    #output {
      white-space: pre-wrap;
      border: 1px solid #ccc;
      padding: 10px;
      width: 300px;
      background-color: #f9f9f9;
    }
    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    input[type="number"] {
      width: 60px;
      padding: 5px;
      font-size: 16px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    textarea {
      width: 300px;
      height: 120px;
      font-family: monospace;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Map Maker 9000</h1>
  <div class="controls">
    <label>
      Rows:
      <input type="number" id="rows-input" min="1" value="10">
    </label>
    <label>
      Columns:
      <input type="number" id="cols-input" min="1" value="10">
    </label>
    <button id="resize-button">Resize Grid</button>
    <label>
      Brush:
      <input type="number" id="brush-input" min="0" max="99" value="1">
    </label>
  </div>
  <div id="grid-container"></div>
  <button id="generate-button">Generate Array</button>
  <div id="output"></div>

  <hr>
  <h2>Import Array</h2>
  <textarea id="import-input" placeholder="Paste your array here"></textarea><br>
  <button id="import-button">Import Array</button>

  <hr>
  <h2>Text to Numbers</h2>
  <input type="text" id="text-input" placeholder="Enter text like HELLO WORLD">
  <button id="convert-button">Convert</button>
  <pre id="converted-output"></pre>
  <label>
    <input type="checkbox" id="underscore-toggle">
    Show 0s as _
  </label>

  <script>
    const gridContainer = document.getElementById('grid-container');
    const rowsInput = document.getElementById('rows-input');
    const colsInput = document.getElementById('cols-input');
    const brushInput = document.getElementById('brush-input');
    const output = document.getElementById('output');
    let grid = [];
    let isPainting = false;

    // ðŸŽ¨ Number color map
    const colorMap = {
      0: "#ddd",    // empty
      1: "#000000", // black wall
      2: "#ff0000", // red
      3: "#00ff00", // green
      4: "#0000ff", // blue
      5: "#ffff00", // yellow
      6: "#ff00ff", // magenta
      7: "#00ffff", // cyan
      8: "#ff8800", // orange
      9: "#8800ff", // purple
      10: "#008888" // teal
    };

    function createGrid(rows, cols, data = null) {
      gridContainer.innerHTML = '';
      gridContainer.style.gridTemplateColumns = `repeat(${cols}, 30px)`;
      grid = Array.from({ length: rows }, () => Array(cols).fill(0));

      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          const cell = document.createElement('div');
          cell.classList.add('cell');
          if (data && data[r] && data[r][c] !== undefined) {
            grid[r][c] = data[r][c];
          } else if (r === 0 || r === rows - 1 || c === 0 || c === cols - 1) {
            grid[r][c] = 1;
          }
          updateCell(cell, r, c);

          cell.dataset.row = r;
          cell.dataset.col = c;

          // Paint on click
          cell.addEventListener('mousedown', () => {
            isPainting = true;
            paintCell(cell);
          });
          // Paint on drag
          cell.addEventListener('mouseover', () => {
            if (isPainting) paintCell(cell);
          });

          gridContainer.appendChild(cell);
        }
      }

      // Stop painting on mouse up
      document.addEventListener('mouseup', () => {
        isPainting = false;
      });
    }

    function updateCell(cell, r, c) {
      const val = grid[r][c];
      cell.textContent = val;
      cell.style.backgroundColor = colorMap[val] || "#555"; // default gray if not mapped
      cell.style.color = val === 0 ? "#000" : "#fff";
    }

    function paintCell(cell) {
      const row = parseInt(cell.dataset.row);
      const col = parseInt(cell.dataset.col);
      const brush = parseInt(brushInput.value) || 0;
      grid[row][col] = brush;
      updateCell(cell, row, col);
    }

    function formatGrid(grid) {
      const underscore = document.getElementById('underscore-toggle').checked;
      return grid
        .map(row => {
          const formattedRow = row.map(val => (underscore && val === 0 ? '_' : val));
          return `    [${formattedRow.join(', ')}]`;
        })
        .join(',\n');
    }

    document.getElementById('resize-button').addEventListener('click', () => {
      const rows = parseInt(rowsInput.value);
      const cols = parseInt(colsInput.value);
      createGrid(rows, cols);
    });

    document.getElementById('generate-button').addEventListener('click', () => {
      output.textContent = `[\n${formatGrid(grid)}\n]`;
    });

    // Import feature
    document.getElementById('import-button').addEventListener('click', () => {
      let text = document.getElementById('import-input').value.trim();
      try {
        text = text.replace(/_/g, "0");
        const data = eval(text);
        if (Array.isArray(data) && Array.isArray(data[0])) {
          rowsInput.value = data.length;
          colsInput.value = data[0].length;
          createGrid(data.length, data[0].length, data);
        } else {
          alert("Invalid array format. Must be a 2D array.");
        }
      } catch (e) {
        alert("Invalid array format. Paste the output directly from the generator.");
      }
    });

    createGrid(parseInt(rowsInput.value), parseInt(colsInput.value));

    document.getElementById('convert-button').addEventListener('click', () => {
      const text = document.getElementById('text-input').value.toUpperCase();
      const outputEl = document.getElementById('converted-output');

      const numbers = Array.from(text).map(char => {
        if (char === ' ') return 0;
        const code = char.charCodeAt(0);
        if (code >= 65 && code <= 90) {
          return code - 64; // A=1, ..., Z=26
        }
        return null;
      }).filter(n => n !== null);

      outputEl.textContent = `[${numbers.join(', ')}]`;
    });
  </script>
</body>
</html>
